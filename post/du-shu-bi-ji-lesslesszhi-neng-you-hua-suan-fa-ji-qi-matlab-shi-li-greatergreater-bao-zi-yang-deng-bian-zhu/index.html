<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>读书笔记《智能优化算法及其MATLAB实例》包子阳等编著 - hugh</title>
<link rel="shortcut icon" href="https://hughlee95.github.io/favicon.ico">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css">
<link rel="stylesheet" href="https://hughlee95.github.io/media/css/tailwind.css">
<link rel="stylesheet" href="https://hughlee95.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="读书笔记《智能优化算法及其MATLAB实例》包子阳等编著 - hugh - Atom Feed" href="https://hughlee95.github.io/atom.xml">

    

  <meta name="description" content="
第二章 遗传算法

遗传算法的特点
改进方向
算法流程
代码流程

Package: mcga
Package: genalg
GA就先不表




第三章 差分进化算法（待续）
第四章 免疫算法（待续）
第五章 蚁群算法（待续完成）

..." />
  <meta property="og:title" content="读书笔记《智能优化算法及其MATLAB实例》包子阳等编著 - hugh">
  <meta property="og:description" content="
第二章 遗传算法

遗传算法的特点
改进方向
算法流程
代码流程

Package: mcga
Package: genalg
GA就先不表




第三章 差分进化算法（待续）
第四章 免疫算法（待续）
第五章 蚁群算法（待续完成）

..." />
  <meta property="og:type" content="articles">
  <meta property="og:url" content="https://hughlee95.github.io/post/du-shu-bi-ji-lesslesszhi-neng-you-hua-suan-fa-ji-qi-matlab-shi-li-greatergreater-bao-zi-yang-deng-bian-zhu/" />
  <meta property="og:image" content="https://hughlee95.github.io/post-images/du-shu-bi-ji-lesslesszhi-neng-you-hua-suan-fa-ji-qi-matlab-shi-li-greatergreater-bao-zi-yang-deng-bian-zhu.jpg">
  <meta property="og:image:height" content="630">
  <meta property="og:image:width" content="1200">
  <meta name="twitter:title" content="读书笔记《智能优化算法及其MATLAB实例》包子阳等编著 - hugh">
  <meta name="twitter:description" content="
第二章 遗传算法

遗传算法的特点
改进方向
算法流程
代码流程

Package: mcga
Package: genalg
GA就先不表




第三章 差分进化算法（待续）
第四章 免疫算法（待续）
第五章 蚁群算法（待续完成）

...">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="canonical" href="https://hughlee95.github.io/post/du-shu-bi-ji-lesslesszhi-neng-you-hua-suan-fa-ji-qi-matlab-shi-li-greatergreater-bao-zi-yang-deng-bian-zhu/">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
 
  
    <link rel="stylesheet" href="https://hughlee95.github.io/media/css/prism-atom-dark.css">
  

  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
  
</head>

<body>
  <div class="antialiased flex flex-col min-h-screen" id="app">
    <a href="https://hughlee95.github.io" class="fixed top-0 left-0 mt-4 bg-black text-white dark:text-gray-700 dark:bg-yellow-50 dark:hover:bg-black dark:hover:text-white inline-flex p-2 pl-8 hover:text-gray-700 hover:bg-yellow-50 font-bold z-10 transition-fast animated fadeInLeft">
      hugh
    </a>
    <div class="max-w-4xl w-full mx-auto">
      <div class="shadow-box bg-white dark:bg-gray-600 rounded-lg pt-32 md:pt-64 px-4 md:px-8 pb-8 animated fadeIn mb-8">
        <h1 class="text-5xl font-semibold leading-normal pb-8 mb-8 border-b-8 border-gray-700">
          读书笔记《智能优化算法及其MATLAB实例》包子阳等编著
        </h1>
        
          <img src="https://hughlee95.github.io/post-images/du-shu-bi-ji-lesslesszhi-neng-you-hua-suan-fa-ji-qi-matlab-shi-li-greatergreater-bao-zi-yang-deng-bian-zhu.jpg" alt="读书笔记《智能优化算法及其MATLAB实例》包子阳等编著" class="block w-full mb-8">
        
        <div class="mb-8 flex flex-wrap">
          <div class="text-gray-400 text-sm mr-4">2021-03-01 · 10 min read</div>
          
            <a href="https://hughlee95.github.io/tag/k_tVGaXiq/" class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              研究
            </a>
          
            <a href="https://hughlee95.github.io/tag/9SurA8kzZ/" class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              读书笔记
            </a>
          
            <a href="https://hughlee95.github.io/tag/cfASU2E0c/" class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              学习
            </a>
          
            <a href="https://hughlee95.github.io/tag/0q9zJmmmte/" class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              南方科技大学
            </a>
          
        </div>
        <div class="markdown mb-8" v-pre>
          <p><ul class="markdownIt-TOC">
<li><a href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95">第二章 遗传算法</a>
<ul>
<li><a href="#%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E7%9A%84%E7%89%B9%E7%82%B9">遗传算法的特点</a></li>
<li><a href="#%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91">改进方向</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B">算法流程</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E6%B5%81%E7%A8%8B">代码流程</a>
<ul>
<li><a href="#package-mcga">Package: mcga</a></li>
<li><a href="#package-genalg">Package: genalg</a></li>
<li><a href="#ga%E5%B0%B1%E5%85%88%E4%B8%8D%E8%A1%A8"><code>GA就先不表</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%B7%AE%E5%88%86%E8%BF%9B%E5%8C%96%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD">第三章 差分进化算法（待续）</a></li>
<li><a href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E5%85%8D%E7%96%AB%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD">第四章 免疫算法（待续）</a></li>
<li><a href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E8%9A%81%E7%BE%A4%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD%E5%AE%8C%E6%88%90">第五章 蚁群算法（待续完成）</a>
<ul>
<li><a href="#%E5%9F%BA%E6%9C%AC%E8%9A%81%E7%BE%A4%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%B5%81%E7%A8%8B">基本蚁群算法及其流程</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%B2%92%E5%AD%90%E7%BE%A4%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD">第六章 粒子群算法（待续）</a></li>
<li><a href="#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD%E5%AE%8C%E6%88%90">第七章 模拟退火算法（待续完成）</a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B-2">算法流程</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E7%A6%81%E5%BF%8C%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95">第八章 禁忌搜索算法</a></li>
</ul>
</p>
<blockquote>
<p>说白了，学习智能算法也只是工具，重要的是掌握<font color=blue size=5><strong>科研的方法</strong></font>。工具就是工具，想法是科研中最重要的事情。<br>
代码我主要采用的是项目模式，所以会比较麻烦一些，用之前查一下R Project怎么建立就好啦</p>
<p>2021年3月1日14点53分</p>
</blockquote>
<h1 id="第二章-遗传算法">第二章 遗传算法</h1>
<p>遗传算法具有对参数的编码进行操作、不需要推到和附加信息、寻优规则非确定性、自组织、自适应和自学习性等特点。<br>
关键术语：<br>
模式阶：模式H中确定位置的个数称作该模式的模式阶，记作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>H</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span><br>
定义距：在模式<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span>中第一个确定位置和最后一个确定位置之间的距离乘坐该模式的定义距，记作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>(</mo><mi>H</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">D(H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span><br>
模式定理：在遗传算法选择、交叉和变异算子的作用下，具有低阶、短定义距，把那个且其平均适应度高于群体平均适应度的模式再子代中将呈指数级增长。<br>
遗传学与遗传算法术语对应关系<br>
<img src="https://hughlee95.github.io/post-images/1614737496687.png" alt="" loading="lazy"></p>
<blockquote>
<p>下面就是抄了</p>
</blockquote>
<ul>
<li>群体和个体<br>
群体是生物进化过程中的一个集团，表示可行解集<br>
个体是造成群体的单个生物体，表示可行解</li>
<li>染色体和基因<br>
染色体是包含生物体所有遗传信息的化合物，表示可行解的编码。<br>
基因是控制社工物体某种性状（即遗传信息）的基本单位，表示可行解编码的分量。</li>
<li>遗传编码<br>
遗传编码将有哈变量转化为基因的组合表示形式，优化变量的编码机制有二进制编码、十进制编码等。</li>
<li>适应度<br>
适应度即生物群体中个体适应生存环境的能力。在遗传算法中，用来评价个体优劣的数学函数，称为个体的适应度函数。</li>
<li>遗传操作<br>
选择、交叉、变异</li>
</ul>
<h2 id="遗传算法的特点">遗传算法的特点</h2>
<ol>
<li>以决策变量的编码作为运算对象。针对一些只有代码概念而无数值概念或者很难有数值概念的优化问题，编码处理方式更显示出了其独特的优越性。</li>
<li>直接以目标函数值作为搜索信息。避免了一些不必搜索的点，相当于搜索了更多的点，这是遗传算法所特有的一种隐含并行性。</li>
<li>一种基于概率的搜索技术。</li>
<li>具有自组织、自适应和自学习等特性。</li>
</ol>
<h2 id="改进方向">改进方向</h2>
<p>编码机制、选择策略、交叉算子、变异算子、特殊算子和参数设计（包括群体规模、交叉概率、b变异概率）</p>
<h2 id="算法流程">算法流程</h2>
<figure data-type="image" tabindex="1"><img src="https://hughlee95.github.io/post-images/1614739276421.png" alt="" loading="lazy"></figure>
<h2 id="代码流程">代码流程</h2>
<blockquote>
<p>就此而言，我主要使用R里面的包进行计算<br>
代码学习来自于<a href="https://ithelp.ithome.com.tw/users/20111679/ironman/2577">GA WITH YOU</a>，我们台湾的小伙伴！！！！！！</p>
</blockquote>
<h3 id="package-mcga">Package: mcga</h3>
<blockquote>
<p>mcga是个很简单的计算方法，不能画图，只能进行计算，需要把参数选好，那么获得的值就会准确很多<br>
<code>library(mcga)</code><br>
<code>mcga(popsize, chsize, crossprob = 1, mutateprob = 0.01, elitism = 1, minval, maxval, maxiter = 10, evalFunc)</code></p>
</blockquote>
<table>
  <tr>
    <th colspan="2">参数说明</th>
  </tr>
  <tr>
    <td>popsize</td>
    <td>种群规模，即染色体数量或个体数目</td>
  </tr>
  <tr>
    <td>chsize</td>
    <td>参数数量</td>
  </tr>
  <tr>
    <td>crosspro</td>
    <td>交叉概率</td>
  </tr>
  <tr>
    <td>mutateprob</td>
    <td>变异概率</td>
  </tr>
  <tr>
    <td>elitism</td>
    <td>直接复制到子代的最佳个体数目</td>
  </tr>
  <tr>
    <td>minval</td>
    <td>随机生成初始种群的下边界值</td>
  </tr>
  <tr>
    <td>maxval</td>
    <td>随机生成初识种群的上边界值</td>
  </tr>
  <tr>
    <td>maxiter</td>
    <td>最大世代数</td>
  </tr>
  <tr>
    <td>evalFunc</td>
    <td>计算个体适应度，每一个问题没默认为是最小化问题</td>
  </tr>
</table>
<h3 id="package-genalg">Package: genalg</h3>
<p><a href="https://www.rdocumentation.org/packages/genalg/versions/0.2.0">Offical Introduction</a><br>
<code>rgba 用于浮点数</code></p>
<table>
  <tr>
    <th colspan="2">参数说明</th>
  </tr>
  <tr>
    <td>stringMin</td>
    <td>vector with minimum values for each gene.</td>
  </tr>
  <tr>
    <td>stringMax</td>
    <td>vector with maximum values for each gene.</td>
  </tr>
  <tr>
    <td>suggestions</td>
    <td>optional list of suggested chromosomes</td>
  </tr>
  <tr>
    <td>popSize</td>
    <td>the population size</td>
  </tr>
  <tr>
    <td>iters</td>
    <td>the number of iterations</td>
  </tr>
  <tr>
    <td>mutationChance</td>
    <td>the chance that a gene in the chromosome mutates. </td>
  </tr>
  <tr>
    <td>elitism</td>
    <td>the number of chromosomes that are kept into the next generation. </td>
  </tr>
  <tr>
    <td>monitorFunc</td>
    <td>Method run after each generation to allow monitoring of the optimization查看每一个优化的结果</td>
  </tr>
  <tr>
    <td>evalFunc</td>
    <td>计算个体适应度，每一个问题没默认为是最小化问题</td>
  </tr>
  <tr>
    <td> showSettings</td>
    <td>if true the settings will be printed to screen. By default False.</td>
  </tr>
  <tr>
    <td>verbose</td>
    <td> true the algorithm will be more verbose. By default False.</td>
  </tr>
</table>
<p><code>rgba.bin用于二进制</code></p>
<table>
  <tr>
    <th colspan="2">参数说明</th>
  </tr>
  <tr>
    <td>size</td>
    <td>the number of genes in the chromosome</td>
  </tr>
  <tr>
    <td>suggestions</td>
    <td>optional list of suggested chromosomes</td>
  </tr>
  <tr>
    <td>popSize</td>
    <td>the population size</td>
  </tr>
  <tr>
    <td>iters</td>
    <td>the number of iterations</td>
  </tr>
  <tr>
    <td>mutationChance</td>
    <td>the chance that a gene in the chromosome mutates. </td>
  </tr>
  <tr>
    <td>elitism</td>
    <td>the number of chromosomes that are kept into the next generation. </td>
  </tr>
  <tr>
    <td>monitorFunc</td>
    <td>Method run after each generation to allow monitoring of the optimization查看每一个优化的结果</td>
  </tr>
  <tr>
    <td>evalFunc</td>
    <td>计算个体适应度，每一个问题没默认为是最小化问题</td>
  </tr>
  <tr>
    <td> showSettings</td>
    <td>if true the settings will be printed to screen. By default False.</td>
  </tr>
  <tr>
    <td>verbose</td>
    <td> true the algorithm will be more verbose. By default False.</td>
  </tr>
  <tr>
    <td>zeroToOneRatio</td>
    <td>the change for a zero for mutations and initialization. This option is used to control the number of set genes in the chromosome. For example, when doing variable selectionm this parameter should be set high to</td>
  </tr>
</table>
#### Code
<p><code>hearder.R</code></p>
<pre><code>library(GA)
library(foreach)
library(iterators)
library(mcga)
library(genalg)
</code></pre>
<p><code>adjustFunction.R</code></p>
<pre><code>getAdjust1&lt;-function(x){
  if(x&gt;=0 &amp;&amp; x&lt;=12.55){
    return(-(x*sin(x)))
  }else{
    return(exp(100))
  }
}
getAdjust2&lt;-function(x){
  if(x&gt;=0 &amp;&amp; x&lt;=10){
    return(-(x+10*sin(5*x)+7*cos(4*x)))
  }else{
    return(exp(100))
  }
}
getAdjust3 &lt;- function(x){
  #multivariable get Minvalue
  return ((x[1]-7)^2 
          +(x[2]-77)^2 
          +(x[3]-777)^2 
          +(x[4]-7777)^2 
          +(x[5]-77777)^2)
}

getAdjust4&lt;-function(string=c()){
  returnVal = 1/sum(string)
  returnVal
}
monitor &lt;- function(rgba0){
  print(rgba0$population[1,])
}
</code></pre>
<p><code>main.R</code></p>
<pre><code>source('src/header.R')
source('Function/adjustFunction.R')
#mcga get minimum value
m2 &lt;-mcga(popsize = 50
         , crossprob = 0.8
         , mutateprob = 0.1
         , chsize = 1
         , minval = 0
         , maxval = 10
         , maxiter = 100
         , evalFunc = getAdjust2 )
m3 &lt;- mcga( popsize=200,
            chsize=5,
            minval=0.0,
            maxval=999999999.9,
            maxiter=2500,
            crossprob=1.0,
            mutateprob=0.01,
            evalFunc = getAdjust3 )

m4 &lt;- rbga(
  stringMin = c(0)
  , stringMax = c(12.55)
  , popSize = 100
  , iters = 1000
  , mutationChance = 0.01
  , monitorFunc = monitor
  , evalFunc = getAdjust1
  , verbose = TRUE)

m5 &lt;- rbga.bin(size=10
               , mutationChance=0.01
               , zeroToOneRatio=0.5
               , evalFunc=getAdjust4 )
#directly get binary chromosome, can solve package problem
m6&lt;- rbga.bin(size=7,
              suggestions=NULL,
              popSize=200,
              iters=100,
              mutationChance=0.01,
              elitism=NA,
              zeroToOneRatio=10,
              monitorFunc=NULL,
              evalFunc=getAdjust3,
              showSettings=FALSE,
              verbose=FALSE)
</code></pre>
<h3 id="ga就先不表"><code>GA就先不表</code></h3>
<blockquote>
<p>其实和之前的大同小异</p>
</blockquote>
<h1 id="第三章-差分进化算法待续">第三章 差分进化算法（待续）</h1>
<h1 id="第四章-免疫算法待续">第四章 免疫算法（待续）</h1>
<h1 id="第五章-蚁群算法待续完成">第五章 蚁群算法（待续完成）</h1>
<p>模拟蚁群觅食过程的蚁群优化算法（Ant Colony Optimization， Aco）<br>
在图中寻求最优化的方法。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>cos</mi><mo>⁡</mo><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>sin</mi><mo>⁡</mo><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>z</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mi>x</mi><mi>y</mi></mfrac></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f(x)=\left\{
\begin{aligned}
x &amp; = &amp; \cos(t) \\
y &amp; = &amp; \sin(t) \\
z &amp; = &amp; \frac xy
\end{aligned}
\right.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.288000000000001em;vertical-align:-2.394000000000001em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65002em;"><span style="top:-1.8999899999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.8999899999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.1999899999999997em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.30001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.90002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.894em;"><span style="top:-5.161560000000001em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.6615599999999997em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-1.8939999999999995em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.394000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.894em;"><span style="top:-5.161560000000001em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-3.6615599999999997em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-1.8939999999999995em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.394000000000001em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.894em;"><span style="top:-5.161560000000001em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span><span style="top:-3.6615599999999997em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span><span style="top:-1.8939999999999995em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">x</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.394000000000001em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="基本蚁群算法及其流程">基本蚁群算法及其流程</h2>
<h1 id="第六章-粒子群算法待续">第六章 粒子群算法（待续）</h1>
<h1 id="第七章-模拟退火算法待续完成">第七章 模拟退火算法（待续完成）</h1>
<p>模拟退火算法是一种基于Monte Carlo迭代求解策略的随机寻优算法。其目的在于为具有NP复杂性的问题提供有效的近似求解算法，它克服了其他优化过程容易陷入局部极小的缺陷和对初值的依赖性。<br>
模拟退火的过程：<br>
加温过程：增强粒子的热运动<br>
等温过程：当自由能达到最小时，紫铜达到平衡状态<br>
冷却过程：其目的是使粒子的热运动减弱并逐渐趋于有序，系统能量逐渐下降，从而得到低能量的晶体结构。<br>
<img src="https://hughlee95.github.io/post-images/1617008291124.png" alt="" loading="lazy"><br>
模拟退火的主要思想：在搜索区间随机游走（即随机选择点），再利用Metropolis抽样准则，使得随机游走逐渐收敛于局部最优解。温度是Metropolis是算法中的一个重要控制参数，可以认为这个参数的大小控制了随机过程向局部或全局最优解移动的快慢。<br>
Metropolis算法描述：系统从一个能量状态变化到另一个状态时，相应的能量从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">E_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>变化到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">E_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其概率如下所示</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mn>1</mn><mo>→</mo><mn>2</mn><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mn>1</mn><mo separator="true">,</mo><msub><mi>E</mi><mn>2</mn></msub><mo>&gt;</mo><msub><mi>E</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mo>−</mo><mfrac><mrow><msub><mi>E</mi><mn>2</mn></msub><mo>−</mo><msub><mi>E</mi><mn>1</mn></msub></mrow><mi>T</mi></mfrac><mo>)</mo><mo separator="true">,</mo><msub><mi>E</mi><mn>2</mn></msub><mo>⩾</mo><msub><mi>E</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">p(1\rightarrow 2)=\left\{
    \begin{aligned}
1, E_2 &gt;E_1\\
exp(-\frac{E_2-E_1}{T}), E_2 \geqslant E_1
\end{aligned}
\right.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.84633em;vertical-align:-1.673165em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.49999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.30002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.173165em;"><span style="top:-4.693495em;"><span class="pstrut" style="height:3.3603300000000003em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6731650000000005em;"><span class="pstrut" style="height:3.3603300000000003em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.673165em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>这样经过一定次数的迭代，系统会逐渐趋于一个稳定的分布状态。</p>
<h2 id="算法流程-2">算法流程</h2>
<p>模拟退火算法流程<br>
<img src="https://hughlee95.github.io/post-images/1617009842883.png" alt="" loading="lazy"><br>
模拟退火关键参数<br>
<img src="https://hughlee95.github.io/post-images/1617009911732.png" alt="" loading="lazy"><br>
<img src="https://hughlee95.github.io/post-images/1617009925526.png" alt="" loading="lazy"></p>
<p><strong>在R语言中，具有相应的包可以完成模拟退火算法，所以不用担心算法难以应用。</strong></p>
<h1 id="第八章-禁忌搜索算法">第八章 禁忌搜索算法</h1>
<p><img src="https://hughlee95.github.io/post-images/1617019875348.png" alt="" loading="lazy"><br>
<img src="https://hughlee95.github.io/post-images/1617022034804.png" alt="" loading="lazy"><br>
<img src="https://hughlee95.github.io/post-images/1617022043805.png" alt="" loading="lazy"></p>
<p>具体的算法应用跟着书里面进行敲就好啦<br>
这是R package，跟着使用说明使用即可。</p>
<pre><code>tabusearch
</code></pre>

        </div>
        <!-- Share to Twitter, Weibo, Telegram -->
        <div class="flex items-center">
          <div class="mr-4 flex items-center">
            <i class="ri-share-forward-line text-gray-500"></i>
          </div>
          <div class="px-4 cursor-pointer text-blue-500 hover:bg-blue-100 dark:hover:bg-gray-600 inline-flex" @click="shareToTwitter">
            <i class="ri-twitter-line"></i>
          </div>
          <div class="px-4 cursor-pointer text-red-500 hover:bg-red-100 dark:hover:bg-gray-600 inline-flex" @click="shareToWeibo">
            <i class="ri-weibo-line"></i>
          </div>
          <div class="px-4 cursor-pointer text-indigo-500 hover:bg-indigo-100 dark:hover:bg-gray-600 inline-flex" @click="shareToTelegram">
            <i class="ri-telegram-line"></i>
          </div>
        </div>
      </div>

      

      
        <div id="vlaine-comment"></div>
      

      <footer class="py-12 text-center px-4 md:px-0" v-pre>
  <p>喜欢我就把我加入收藏夹</p>
</footer>
    </div>

    <!-- TOC Container -->
    <div class="fixed right-0 bottom-0 mb-16 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white dark:bg-gray-500 dark:text-gray-200 hover:shadow-lg transition-all animated fadeInRight" @click="showToc = true">
      <i class="ri-file-list-line"></i>
    </div>

    <div class="fixed right-0 top-0 bottom-0 overflow-y-auto w-64 bg-white dark:bg-gray-800 p-4 border-l border-gray-100 dark:border-gray-600 z-10 transition-fast" :class="{ '-mr-64': !showToc }">
      <div class="flex mb-4 justify-end">
        <div class="w-8 h-8 inline-flex justify-center items-center rounded-full cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-fast" @click="showToc = false">
          <i class="ri-close-line text-lg"></i>
        </div>
      </div>
      <div class="post-toc-container">
        <ul class="markdownIt-TOC">
<li><a href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95">第二章 遗传算法</a>
<ul>
<li><a href="#%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E7%9A%84%E7%89%B9%E7%82%B9">遗传算法的特点</a></li>
<li><a href="#%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91">改进方向</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B">算法流程</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E6%B5%81%E7%A8%8B">代码流程</a>
<ul>
<li><a href="#package-mcga">Package: mcga</a></li>
<li><a href="#package-genalg">Package: genalg</a></li>
<li><a href="#ga%E5%B0%B1%E5%85%88%E4%B8%8D%E8%A1%A8"><code>GA就先不表</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%B7%AE%E5%88%86%E8%BF%9B%E5%8C%96%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD">第三章 差分进化算法（待续）</a></li>
<li><a href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E5%85%8D%E7%96%AB%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD">第四章 免疫算法（待续）</a></li>
<li><a href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E8%9A%81%E7%BE%A4%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD%E5%AE%8C%E6%88%90">第五章 蚁群算法（待续完成）</a>
<ul>
<li><a href="#%E5%9F%BA%E6%9C%AC%E8%9A%81%E7%BE%A4%E7%AE%97%E6%B3%95%E5%8F%8A%E5%85%B6%E6%B5%81%E7%A8%8B">基本蚁群算法及其流程</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%B2%92%E5%AD%90%E7%BE%A4%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD">第六章 粒子群算法（待续）</a></li>
<li><a href="#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB%E7%AE%97%E6%B3%95%E5%BE%85%E7%BB%AD%E5%AE%8C%E6%88%90">第七章 模拟退火算法（待续完成）</a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B-2">算法流程</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E7%A6%81%E5%BF%8C%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95">第八章 禁忌搜索算法</a></li>
</ul>

      </div>
    </div>

    <!-- Back to top -->
    <div class="fixed right-0 bottom-0 mb-4 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white hover:shadow-lg transition-all dark:bg-gray-500 dark:text-gray-200" @click="backToUp" v-show="scrolled">
      <i class="ri-arrow-up-line"></i>
    </div>
  </div>

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
  <!-- Background of PhotoSwipe. 
        It's a separate element as animating opacity is faster than rgba(). -->
  <div class="pswp__bg">
  </div>
  <!-- Slides wrapper with overflow:hidden. -->
  <div class="pswp__scroll-wrap">
    <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
    <div class="pswp__container">
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
    </div>
    <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
    <div class="pswp__ui pswp__ui--hidden">
      <div class="pswp__top-bar">
        <!--  Controls are self-explanatory. Order can be changed. -->
        <div class="pswp__counter">
        </div>
        <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
        <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
        <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
        <!-- element will get class pswp__preloader--active when preloader is running -->
        <div class="pswp__preloader">
          <div class="pswp__preloader__icn">
            <div class="pswp__preloader__cut">
              <div class="pswp__preloader__donut">
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
        <div class="pswp__share-tooltip">
        </div>
      </div>
      <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
      </button>
      <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
      </button>
      <div class="pswp__caption">
        <div class="pswp__caption__center">
        </div>
      </div>
    </div>
  </div>
</div>

  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://hughlee95.github.io/media/scripts/main.js"></script>
  
  <!-- Code Highlight -->
  
    <script src="https://hughlee95.github.io/media/prism.js"></script>
    <script>
      Prism.highlightAll()
    </script>
  

  <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>
  <script>
    //拿到预览框架，也就是上面的html代码
    var pswpElement = document.querySelectorAll('.pswp')[0];
    //定义图片数组变量
    var imgitems;
    /**
    * 用于显示预览界面
    * @param index 图片数组下标
    */
    function viewImg(index) {
      //其它选项这里不做过多阐述，详情见官网
      var pswpoptions = {
        index: parseInt(index, 10), // 开始幻灯片索引。0是第一张幻灯片。必须是整数，而不是字符串。
        bgOpacity: 0.7, // 背景透明度，0-1
        maxSpreadZoom: 3, // 缩放级别，不要太大
      };
      //初始化并打开PhotoSwipe，pswpElement对应上面预览框架，PhotoSwipeUI_Default为皮肤，imgitems为图片数组，pswpoptions为选项
      var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, imgitems, pswpoptions);
      gallery.init()
    }
    /**
    * 用于添加图片点击事件
    * @param img 图片元素
    * @param index 所属下标（在imgitems中的位置）
    */
    function addImgClick(img, index) {
      img.onclick = function() {
        viewImg(index)
      }
    }
    /**
    * 轮询所有图片，获取src、width、height等数据，加入imgitems，并给图片元素添加事件
    * 最好在onload中执行该方法，本站因放在最底部，所以直接初始化
    * 异步加载图片可在图片元素创建完成后调用此方法
    */
    function initImg() {
      //重置图片数组
      imgitems = [];
      //查找class:markdown 下的所有img元素并遍历
      var imgs = document.querySelectorAll('.markdown img');
      for (var i = 0; i < imgs.length; i++) {
        var img = imgs[i];
        //本站相册初始为loading图片，真实图片放在data-src
        var ds = img.getAttribute("data-src");
        //创建image对象，用于获取图片宽高
        var imgtemp = new Image();
        //判断是否存在data-src
        if (ds != null && ds.length > 0) {
          imgtemp.src = ds
        } else {
          imgtemp.src = img.src
        }
        //判断是否存在缓存
        if (imgtemp.complete) {
          var imgobj = {
            "src": imgtemp.src,
            "w": imgtemp.width,
            "h": imgtemp.height,
          };
          imgitems[i] = imgobj;
          addImgClick(img, i);
        } else {
          console.log('进来了2')
          imgtemp.index = i;
          imgtemp.img = img;
          imgtemp.onload = function() {
            var imgobj = {
              "src": this.src,
              "w": this.width,
              "h": this.height,
            };
            //不要使用push，因为onload前后顺序会不同
            imgitems[this.index] = imgobj
            //添加点击事件
            addImgClick(this.img, this.index);
          }
        }
      }
    }
    //初始化
    initImg();
  </script>
  
    <script type="application/javascript" src="https://unpkg.com/valine"></script>
<script type="application/javascript">
  new Valine({
    el: '#vlaine-comment',
    appId: '',
    appKey: '',
    pageSize: 10,
    notify: true,
    avatar: 'mp',
    verify: true,
    placeholder: '我好希望你告诉我你的想法呢！！！！',
    visitor: true,
    highlight: true,
    recordIP: true,
  })
</script>
  
  
</body>

</html>